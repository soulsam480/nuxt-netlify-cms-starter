<!doctype html>
<html data-n-head-ssr lang="en-US" data-n-head="%7B%22lang%22:%7B%22ssr%22:%22en-US%22%7D%7D">
  <head>
    <title>Paytm payments for serverless websites | Sambit Sahoo</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" data-hid="og:site_name" property="og:site_name" content="Sambit Sahoo"><meta data-n-head="ssr" data-hid="mobile-web-app-capable" name="mobile-web-app-capable" content="yes"><meta data-n-head="ssr" data-hid="apple-mobile-web-app-title" name="apple-mobile-web-app-title" content="Sambit Blog"><meta data-n-head="ssr" data-hid="author" name="author" content="Code Tribe"><meta data-n-head="ssr" data-hid="theme-color" name="theme-color" content="#03fcc2"><meta data-n-head="ssr" data-hid="article:published_time" property="article:published_time" content="2020-08-17T13:43:47.409Z"><meta data-n-head="ssr" data-hid="article:modified_time" property="article:modified_time" content="2020-08-17T13:43:47.465Z"><meta data-n-head="ssr" data-hid="og:updated_time" property="og:updated_time" content="2020-08-17T13:43:47.465Z"><meta data-n-head="ssr" data-hid="og:url" property="og:url" content="https://sambitsahoo.com/blog/paytm-payments-for-serverless-websites"><meta data-n-head="ssr" data-hid="og:title" property="og:title" content="Paytm payments for serverless websites | Sambit Sahoo"><meta data-n-head="ssr" data-hid="description" name="description" content="Paytm payments integration for serverless JAMstack websites using Netlify lambda functions. This repo will save you from the nightmare of setting up a serverless payment integration from scratch."><meta data-n-head="ssr" data-hid="og:description" property="og:description" content="Paytm payments integration for serverless JAMstack websites using Netlify lambda functions. This repo will save you from the nightmare of setting up a serverless payment integration from scratch."><meta data-n-head="ssr" data-hid="og:image" property="og:image" content="https://sambitsahoo.com//images/uploads/group-1.png"><meta data-n-head="ssr" data-hid="og:image:alt" property="og:image:alt" content="Paytm payments for serverless websites"><meta data-n-head="ssr" data-hid="og:type" property="og:type" content="article"><meta data-n-head="ssr" data-hid="og:article:author" property="og:article:author" content="https://github.com/soulsam480"><meta data-n-head="ssr" data-hid="twitter:card" name="twitter:card" content="summary_large_image"><meta data-n-head="ssr" data-hid="twitter:title" name="twitter:title" content="Paytm payments for serverless websites"><meta data-n-head="ssr" data-hid="twitter:site" name="twitter:site" content="@sambitsahoojs"><meta data-n-head="ssr" data-hid="twitter:description" name="twitter:description" content="Paytm payments integration for serverless JAMstack websites using Netlify lambda functions. This repo will save you from the nightmare of setting up a serverless payment integration from scratch."><meta data-n-head="ssr" data-hid="twitter:image" name="twitter:image" content="https://sambitsahoo.com//images/uploads/group-1.png"><base href="/"><link data-n-head="ssr" rel="icon" type="image/x-icon" href="/favicon.ico"><link data-n-head="ssr" rel="manifest" href="/_nuxt/manifest.48457cca.json"><link data-n-head="ssr" rel="shortcut icon" href="/_nuxt/icons/icon_150x150.ae673c.png"><link data-n-head="ssr" rel="apple-touch-icon" href="/_nuxt/icons/icon_512x512.ae673c.png" sizes="512x512"><link rel="preload" href="/_nuxt/runtime.3eff002.js" as="script"><link rel="preload" href="/_nuxt/vendors/commons.75b201b.js" as="script"><link rel="preload" href="/_nuxt/app.e4de9c7.js" as="script"><link rel="preload" href="/_nuxt/pages/blog/_slug.dd3f79c.js" as="script"><style data-vue-ssr-id="5764bbd8:0 019e1cef:0 84455a9e:0 55de64b8:0 e309b01c:0 27125efc:0 1c78f610:0">.svg-inline--fa,svg:not(:root).svg-inline--fa{overflow:visible}.svg-inline--fa{display:inline-block;font-size:inherit;height:1em;vertical-align:-.125em}.svg-inline--fa.fa-lg{vertical-align:-.225em}.svg-inline--fa.fa-w-1{width:.0625em}.svg-inline--fa.fa-w-2{width:.125em}.svg-inline--fa.fa-w-3{width:.1875em}.svg-inline--fa.fa-w-4{width:.25em}.svg-inline--fa.fa-w-5{width:.3125em}.svg-inline--fa.fa-w-6{width:.375em}.svg-inline--fa.fa-w-7{width:.4375em}.svg-inline--fa.fa-w-8{width:.5em}.svg-inline--fa.fa-w-9{width:.5625em}.svg-inline--fa.fa-w-10{width:.625em}.svg-inline--fa.fa-w-11{width:.6875em}.svg-inline--fa.fa-w-12{width:.75em}.svg-inline--fa.fa-w-13{width:.8125em}.svg-inline--fa.fa-w-14{width:.875em}.svg-inline--fa.fa-w-15{width:.9375em}.svg-inline--fa.fa-w-16{width:1em}.svg-inline--fa.fa-w-17{width:1.0625em}.svg-inline--fa.fa-w-18{width:1.125em}.svg-inline--fa.fa-w-19{width:1.1875em}.svg-inline--fa.fa-w-20{width:1.25em}.svg-inline--fa.fa-pull-left{margin-right:.3em;width:auto}.svg-inline--fa.fa-pull-right{margin-left:.3em;width:auto}.svg-inline--fa.fa-border{height:1.5em}.svg-inline--fa.fa-li{width:2em}.svg-inline--fa.fa-fw{width:1.25em}.fa-layers svg.svg-inline--fa{bottom:0;left:0;margin:auto;position:absolute;right:0;top:0}.fa-layers{display:inline-block;height:1em;position:relative;text-align:center;vertical-align:-.125em;width:1em}.fa-layers svg.svg-inline--fa{transform-origin:center center}.fa-layers-counter,.fa-layers-text{display:inline-block;position:absolute;text-align:center}.fa-layers-text{left:50%;top:50%;transform:translate(-50%,-50%);transform-origin:center center}.fa-layers-counter{background-color:#ff253a;border-radius:1em;box-sizing:border-box;color:#fff;height:1.5em;line-height:1;max-width:5em;min-width:1.5em;overflow:hidden;padding:.25em;right:0;text-overflow:ellipsis;top:0;transform:scale(.25);transform-origin:top right}.fa-layers-bottom-right{bottom:0;right:0;top:auto;transform:scale(.25);transform-origin:bottom right}.fa-layers-bottom-left{bottom:0;left:0;right:auto;top:auto;transform:scale(.25);transform-origin:bottom left}.fa-layers-top-right{right:0;top:0;transform:scale(.25);transform-origin:top right}.fa-layers-top-left{left:0;right:auto;top:0;transform:scale(.25);transform-origin:top left}.fa-lg{font-size:1.33333em;line-height:.75em;vertical-align:-.0667em}.fa-xs{font-size:.75em}.fa-sm{font-size:.875em}.fa-1x{font-size:1em}.fa-2x{font-size:2em}.fa-3x{font-size:3em}.fa-4x{font-size:4em}.fa-5x{font-size:5em}.fa-6x{font-size:6em}.fa-7x{font-size:7em}.fa-8x{font-size:8em}.fa-9x{font-size:9em}.fa-10x{font-size:10em}.fa-fw{text-align:center;width:1.25em}.fa-ul{list-style-type:none;margin-left:2.5em;padding-left:0}.fa-ul>li{position:relative}.fa-li{left:-2em;position:absolute;text-align:center;width:2em;line-height:inherit}.fa-border{border:.08em solid #eee;border-radius:.1em;padding:.2em .25em .15em}.fa-pull-left{float:left}.fa-pull-right{float:right}.fa.fa-pull-left,.fab.fa-pull-left,.fal.fa-pull-left,.far.fa-pull-left,.fas.fa-pull-left{margin-right:.3em}.fa.fa-pull-right,.fab.fa-pull-right,.fal.fa-pull-right,.far.fa-pull-right,.fas.fa-pull-right{margin-left:.3em}.fa-spin{-webkit-animation:fa-spin 2s linear infinite;animation:fa-spin 2s linear infinite}.fa-pulse{-webkit-animation:fa-spin 1s steps(8) infinite;animation:fa-spin 1s steps(8) infinite}@-webkit-keyframes fa-spin{0%{transform:rotate(0)}to{transform:rotate(1turn)}}@keyframes fa-spin{0%{transform:rotate(0)}to{transform:rotate(1turn)}}.fa-rotate-90{transform:rotate(90deg)}.fa-rotate-180{transform:rotate(180deg)}.fa-rotate-270{transform:rotate(270deg)}.fa-flip-horizontal{transform:scaleX(-1)}.fa-flip-vertical{transform:scaleY(-1)}.fa-flip-both,.fa-flip-horizontal.fa-flip-vertical{transform:scale(-1)}:root .fa-flip-both,:root .fa-flip-horizontal,:root .fa-flip-vertical,:root .fa-rotate-180,:root .fa-rotate-270,:root .fa-rotate-90{-webkit-filter:none;filter:none}.fa-stack{display:inline-block;height:2em;position:relative;width:2.5em}.fa-stack-1x,.fa-stack-2x{bottom:0;left:0;margin:auto;position:absolute;right:0;top:0}.svg-inline--fa.fa-stack-1x{height:1em;width:1.25em}.svg-inline--fa.fa-stack-2x{height:2em;width:2.5em}.fa-inverse{color:#fff}.sr-only{border:0;clip:rect(0,0,0,0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}.sr-only-focusable:active,.sr-only-focusable:focus{clip:auto;height:auto;margin:0;overflow:visible;position:static;width:auto}.svg-inline--fa .fa-primary{fill:currentColor;fill:var(--fa-primary-color,currentColor);opacity:1;opacity:var(--fa-primary-opacity,1)}.svg-inline--fa .fa-secondary{fill:currentColor;fill:var(--fa-secondary-color,currentColor)}.svg-inline--fa .fa-secondary,.svg-inline--fa.fa-swap-opacity .fa-primary{opacity:.4;opacity:var(--fa-secondary-opacity,.4)}.svg-inline--fa.fa-swap-opacity .fa-secondary{opacity:1;opacity:var(--fa-primary-opacity,1)}.svg-inline--fa mask .fa-primary,.svg-inline--fa mask .fa-secondary{fill:#000}.fad.fa-inverse{color:#fff}.nuxt-progress{position:fixed;top:0;left:0;right:0;height:2px;width:0;opacity:1;transition:width .1s,opacity .4s;background-color:#fff;z-index:999999}.nuxt-progress.nuxt-progress-notransition{transition:none}.nuxt-progress-failed{background-color:red}code{display:inline;font-size:.8rem;padding:5px}code,pre{overflow-x:auto;background-color:#2e3338;color:#fff;border-radius:2px}pre{overflow-y:hidden;padding:10px 5px;margin:5px 0}pre code{word-wrap:break-word;max-width:100%}pre+h2{margin-top:20px}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em}ul p,ul ul{margin-bottom:5px}html{font-size:18px;word-spacing:.5px}body,html{box-sizing:border-box;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}.darkmode{background-color:#1b262c!important;color:#fff!important}.darkmode a{color:#fff}.darkmode .navbar-inner{background-color:#222831!important}.darkmode .navbar-inner .nav-link,.darkmode .post-meta{color:#fff!important}:root,html{color:#252525;font-family:Merriweather,serif!important}*,:after,:before{box-sizing:border-box;margin:0}h1,h2,h3,h4,h5,h6{line-height:1.2;margin-bottom:5px;font-weight:400}h1{font-size:2.4rem;margin-top:6rem}h1+p{margin-top:1.2rem}h2{font-size:1.8rem}h2+p{margin-top:1rem}h3{font-size:1.5rem}h3+p{margin-top:1rem}h4{font-size:1.2rem;margin-top:1.6rem}h4+p{margin-top:.8rem}p{margin-top:0;margin-bottom:10px;font-size:18px;line-height:1.6}a{color:#252525;text-decoration:none;box-shadow:inset 0 -1px 0 currentColor;transition:color 80ms ease-in,box-shadow .13s ease-in-out}a:hover{box-shadow:inset 0 0 0 currentcolor,0 3px 0 currentcolor}ul{padding-left:1rem;font-size:1rem;line-height:1.6;margin-top:0;margin-bottom:1.6rem}::-moz-selection{background:#e5e5e5}::selection{background:#e5e5e5}main{margin:40px 0}@media (max-width:567px){main{margin:40px 0}}.fade-enter-active{-webkit-animation:acrossIn .2s ease-out both;animation:acrossIn .2s ease-out both}@media (max-width:567px){.fade-enter-active{-webkit-animation:none;animation:none}}.fade-leave-active{-webkit-animation:acrossOut .2s ease-in both;animation:acrossOut .2s ease-in both}@media (max-width:567px){.fade-leave-active{-webkit-animation:none;animation:none}}@-webkit-keyframes acrossIn{0%{opacity:0;transform:translateX(-64px)}to{opacity:1;transform:translateX(0)}}@keyframes acrossIn{0%{opacity:0;transform:translateX(-64px)}to{opacity:1;transform:translateX(0)}}@-webkit-keyframes acrossOut{0%{opacity:1;transform:translateX(0)}to{opacity:0;transform:translateX(64px)}}@keyframes acrossOut{0%{opacity:1;transform:translateX(0)}to{opacity:0;transform:translateX(64px)}}.navbar[data-v-301a6c76]{width:100%!important;position:fixed;top:0;z-index:1000}.navbar .navbar-inner[data-v-301a6c76]{display:flex;flex-direction:row;justify-content:space-between;margin:0 auto;align-items:center;background-color:#fff}@media (max-width:600px){.navbar .navbar-inner[data-v-301a6c76]{padding-top:10px;padding-bottom:10px}}.navbar .navbar-inner .brand[data-v-301a6c76]{display:block;font-weight:700;text-align:left}@media only screen and (max-width:600px){.navbar .navbar-inner .brand[data-v-301a6c76]{display:none}}.navbar .navbar-inner .brand img[data-v-301a6c76]{height:24px;display:block}.navbar .navbar-inner .brand a[data-v-301a6c76]{padding:1rem;display:block;box-shadow:none;cursor:pointer}.navbar .navbar-inner .sec-nav[data-v-301a6c76]{font-weight:500;text-align:left}.navbar .navbar-inner .sec-nav a[data-v-301a6c76]{padding:10px;box-shadow:none;cursor:pointer}.navbar .navbar-inner .darkone[data-v-301a6c76]{padding-right:10px}.navbar .navbar-inner .switch[data-v-301a6c76]{position:relative;width:45px;display:inline-block;height:21px}.navbar .navbar-inner .switch input[data-v-301a6c76]{opacity:0;width:0;height:0}.navbar .navbar-inner .slider[data-v-301a6c76]{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:#333;transition:.4s}.navbar .navbar-inner .slider[data-v-301a6c76]:before{position:absolute;content:"";height:15px;width:15px;top:3px;bottom:3px;left:2px;right:2px;background-color:#fff;transition:.4s}.navbar .navbar-inner input:checked+.slider[data-v-301a6c76]{background-color:#ccc}.navbar .navbar-inner input:focus+.slider[data-v-301a6c76]{box-shadow:0 0 1px #fff}.navbar .navbar-inner input:checked+.slider[data-v-301a6c76]:before{transform:translateX(26px)}.navbar .navbar-inner input:checked+.slider.round[data-v-301a6c76]:before{background-color:#252525}.navbar .navbar-inner .slider.round[data-v-301a6c76]{border-radius:100px}.navbar .navbar-inner .slider.round[data-v-301a6c76]:before{border-radius:50%;content:"";color:#000}.share-this-popover{-webkit-animation:share-this .36s linear forwards;animation:share-this .36s linear forwards}.share-this-popover:before{border-color:#252525 transparent;border-style:solid;border-width:.4em .4em 0;bottom:100%;content:"";height:0;left:50%;transform:translateX(-50%);margin:0;position:absolute;width:0}.share-this-popover ul{background-color:#252525;border-radius:.5rem;transform:translate(-50%,-110%);background:linear-gradient(180deg,rgba(49,49,47,.99),#252525);margin:0;display:inline-block;color:#fff;left:50%;display:flex;list-style:none;position:absolute;white-space:nowrap;padding:.5rem .7rem}.share-this-popover ul li{display:inline-block;height:1.2rem;line-height:1.2rem;text-align:center;margin:0;padding:0 .4rem;width:2rem}.share-this-popover ul li:first-child{padding-left:0;width:1.6rem}.share-this-popover ul li:last-child{padding-right:0;width:1.6rem}.share-this-popover ul li a{color:#fff;box-shadow:none;display:block}.post .meta-section,.post .thumbnail{margin-bottom:2.4rem}.post .thumbnail{width:100%;height:auto}.post .meta-section{text-align:left;display:block}.post .meta-section .post-meta{padding-top:5px;margin:0;color:#8a8a8a;font-size:15px}.post h1{margin-top:0;margin-bottom:2rem;display:block;width:100%}.post{padding:40px 0}@media (max-width:567px){.post{padding:40px 0}}@-webkit-keyframes share-this{0%{opacity:0;transform:matrix(.97,0,0,1,0,12)}20%{opacity:.7;transform:matrix(.99,0,0,1,0,2)}40%{opacity:1;transform:matrix(1,0,0,1,0,-1)}70%{opacity:1;transform:matrix(1,0,0,1,0,0)}to{opacity:1;transform:matrix(1,0,0,1,0,0)}}@keyframes share-this{0%{opacity:0;transform:matrix(.97,0,0,1,0,12)}20%{opacity:.7;transform:matrix(.99,0,0,1,0,2)}40%{opacity:1;transform:matrix(1,0,0,1,0,-1)}70%{opacity:1;transform:matrix(1,0,0,1,0,0)}to{opacity:1;transform:matrix(1,0,0,1,0,0)}}.container{display:block;max-width:1200px;margin:0 auto;padding:0 1rem}.container.flex{display:flex;flex-direction:row;justify-content:space-between;flex-wrap:wrap}@media (max-width:567px){.container.flex{display:block}}.container.narrow{max-width:760px}.footer{padding:2rem 0}@media (max-width:567px){.footer{padding:1.2rem 0}}.footer .social-icons{padding:0;margin:0;list-style-type:none;line-height:1}.footer .social-icons li{display:inline}.footer .social-icons li a{display:inline-block;padding:11px 10px 10px;box-shadow:none}</style><link rel="preload" href="/_nuxt/static/1601654154/blog/paytm-payments-for-serverless-websites/payload.js" as="script">
  </head>
  <body>
    <div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><div><nav id="navbar" role="navigation" class="navbar" data-v-301a6c76><div class="navbar-inner" data-v-301a6c76><div class="brand" data-v-301a6c76><a href="/" class="nav-link nuxt-link-active" data-v-301a6c76>
        ZoroZuro
      </a></div> <div class="sec-nav" data-v-301a6c76><a href="/about" class="nav-link" data-v-301a6c76>
        /About
      </a> <a href="/" class="nav-link nuxt-link-active" data-v-301a6c76>
        /Blog
      </a></div> <br data-v-301a6c76> <div class="darkone" data-v-301a6c76><label class="switch" data-v-301a6c76><input type="checkbox" data-v-301a6c76> <span class="slider round" data-v-301a6c76></span></label></div></div></nav> <main id="main" role="main" class="main"><section class="post"><div class="container meta-section narrow"><h2>Paytm payments for serverless websites</h2> <p class="post-meta">
      Posted on Monday, Aug 17, 2020 by
      <a href="https://github.com/soulsam480">soulsam480</a></p></div> <div class="container narrow"><img alt="Paytm payments for serverless websites" class="thumbnail"> <div id="shareable" class="post-content"><h2>Paytm-Netlify-Lambda 🚀</h2>
<p><a href="https://paytm.com">Paytm</a> payments integration for serverless JAMstack websites using <a href="https://www.netlify.com/products/functions/">Netlify lambda</a> functions. This repo will save you from the nightmare of setting up a serverless payment integration from scratch.</p>
<p>🚀 It's live <a href="https://tiaamo.com">here</a></p>
<p>💥 GitHub repo is <a href="https://github.com/soulsam480/paytm-netlify-lambda">here</a></p>
<h3>📑 Table of Contents</h3>
<ul>
<li>🔰 [Getting Started</li>
<li>📐 Setup
<ul>
<li>🌱 Basic Setup</li>
<li>🔥 Usage with Firebase</li>
</ul>
</li>
<li>🗜 Integration</li>
<li>📓 Notes
<ul>
<li>🤓 How it Works ?</li>
<li>🌋 Errors</li>
<li>📔 References</li>
</ul>
</li>
</ul>
<h3>Getting Started</h3>
<p>To get started clone this repo.</p>
<pre><code>git clone git@github.com:soulsam480/paytm-netlify-lambda.git

cd paytm-netlify-lambda

npm install
</code></pre>
<p>To serve the lambda functions locally we can run</p>
<pre><code>npm run start
</code></pre>
<p>But before that we have to setup the functions otherwise there will be errors!!</p>
<h3>Setup</h3>
<p>Open the repo in your favorite text-editor and the file structure will be like this</p>
<ul>
<li>config</li>
<li>dist</li>
<li>src
<ul>
<li>cred</li>
<li>paytm
<ul>
<li>checksum.js</li>
<li>crypt.js</li>
<li>paytm_config.js</li>
<li>paytmChecksum.js</li>
</ul>
</li>
<li>payConf.js</li>
<li>payment.js</li>
</ul>
</li>
</ul>
<p>Webpack cofig sits inside the config folder. All our functions will be build into the dist folder. So it's good if we don't touch that folder.</p>
<h4>Basic Setup</h4>
<p>Open paytm_config.js inside the paytm folder.</p>
<pre><code>module.exports = {
  paytm_config: {
    PAYTM_ENVIRONMENT: "TEST", //possible values:  TEST | PROD
    MID: " Your MID", // Get it From https://dashboard.paytm.com/next/apikeys use Test id for test purpose and Production id for Production Purpose
    WEBSITE: "WEBSTAGING", // USE WEBSTAGING for testing, You Will get it for Production here https://dashboard.paytm.com/next/apikeys
    CHANNEL_ID: "WEB", // Use WEB for Desktop Website and WAP for Mobile Website
    INDUSTRY_TYPE_ID: "Retail", // Use Retail for Testing, For Production You Can Get it from here https://dashboard.paytm.com/next/apikeys
    MERCHANT_KEY: " Your MERCHANT_KEY", // Get it From https://dashboard.paytm.com/next/apikeys use Test key for test purpose and Production key for Production Purpose
    CALLBACK_URL:
      "https://your_unique_site_id.netlify.app/.netlify/functions/payConf", // Modify and Use this url for verifying payment
  },
};
</code></pre>
<p>Change the MID and Merchant Key to your paytm merchant account. The callback url will be updated after you have deployed these functions to netlify. So we will leave it as it is. Again if you wish to change the parameters for production build, the respective fields will be changed with the production credentials.</p>
<p>If you don't wish to use firebase for order validation and confirmation, you can stop here and remove firebase completely from the project. If you wish to use, let's move in to the next step.</p>
<h4>Usage with Firebase</h4>
<p>We will use <a href="npmjs.com/package/firebase-admin">firebase-admin</a> sdk for nodejs to access admin privilages. With firebase admin running on server we can perform CRUD operations on realtime database easily.</p>
<p>To setup admin sdk you need a firebase service account. To get yourself one open you firebase admin dashboard and then project settings > service accounts. Create one for your project and download the credentials in json. Then open src/cred/authKey.js . Add the credentials in their respective places.</p>
<pre><code>module.exports = {
  authKey: {
    type: "service_account",
    project_id: "Your Project id",
    private_key_id: " Your PRIVATE_KEY_ID",
    private_key: "Your PRIVATE_KEY",
    client_email: "Your client email",
    client_id: "Your client id",
    auth_uri: "your auth uri",
    token_uri: "auth token uri",
    auth_provider_x509_cert_url: "cert url provider",
    client_x509_cert_url: " your CERT_URL",
  },
};
</code></pre>
<p>Then open src/payConf.js and add your database URL. With this the setup is complete.</p>
<p>After each successful payment firebase-admin will create an order inside</p>
<pre><code>Orders/dd_mm_yy(current date)/orderId
</code></pre>
<p>this could be further used to verify an proceed with the payment. This is the only advantage of using firebase inside this project. If you don't wish to verify your orders, you can drop firebase completely and move on with the basic approach.</p>
<p>As the setup is complete you can deploy this project to netlify by pushing the code into an it repo. The instruction on how to deploy from a git repo is <a href="https://docs.netlify.com/configure-builds/get-started/#basic-build-settings">here</a></p>
<p>There are two methods to integrate these functions to your project.</p>
<h3>Integration</h3>
<p>This method makes a POST request to the api and creates and submits the form clent-side in browser.
Let's move further for a good explanation.</p>
<p>To make API calls you have to pass these parameters inside the body of your post request. Here is an example using axios.</p>
<pre><code>axios({
        method: "post",
        url:
          "https://your_unique_netliy_appname.netlify.app/.netlify/functions/payment",
        data: {
          amount: payment amount, //must be an integer Mandatory
          name: "customer_name", // _ is allowed.no space allowed inbetween. ex. Sambit_sahoo
          email: "customer_email", //valid customer email
          orderid: "Order_id", //mandatory.no space allowed inbetween ex. OD123231 or OD_12324
          mobile: "customer_mobileno",
        },
        headers: {
          "Content-Type": "application/json",
        },
      })
        .then(async (res) => {
          console.log(res);
          const params = res.data.params;
          params["CHECKSUMHASH"] = res.data.checksum;
          
          //Here the helper function post.js creates the from api response and submits.
          
          post({
            action: res.data.action,
            target: "_self",
            params: params,
          });
        })
        .catch((err) => {
          window.alert(err);
        });

</code></pre>
<p>Here is the helper function which creates and submits the form client side inside browser.</p>
<pre><code>//This plugin is used to perform form action request from jsvascript.
//This is derived from https://github.com/jisaacks/react-post/blob/master/src/post.js
function isDate(val) {
  // Cross realm comptatible
  return Object.prototype.toString.call(val) === "[object Date]";
}

function isObj(val) {
  return typeof val === "object";
}

export function stringifyValue(val) {
  if (isObj(val) && !isDate(val)) {
    return JSON.stringify(val);
  } else {
    return val;
  }
}

function buildForm({ action, target, params }) {
  const form = document.createElement("form");
  form.setAttribute("method", "post");
  form.setAttribute("action", action);
  form.setAttribute("target", target);

  Object.keys(params).forEach((key) => {
    const input = document.createElement("input");
    input.setAttribute("type", "hidden");
    input.setAttribute("name", key);
    input.setAttribute("value", stringifyValue(params[key]));
    form.appendChild(input);
  });

  return form;
}

export default function post(details) {
  const form = buildForm(details);
  console.log(form);
  document.body.appendChild(form);
  form.submit();
  form.remove();
}
</code></pre>
<p>Again after a successful payment you will be redirected to the page sent from the payment confirmation function i.e. payConf.js.</p>
<p>To change your response URLs
go to line 89 for payment success URL, line 93 and 96 for Failure URL.</p>
<h3>Notes</h3>
<p>This project is an wrapper and improvement over the project created by <a href="https://github.com/imlolman">Satyam</a>. You can find the github repo  <a href="https://github.com/imlolman/Paytm-Payment-Gateway-Integration-using-Google-Cloud-Function">here</a>. He implemented this approach using firebase cloud functions.</p>
<h4>How it Works</h4>
<p><a href="https://docs.netlify.com/functions/overview/">Netlify functions</a> are AWS lambda functions which return a callback for an API request. I originally intended to implement this approach without <a href="https://expressjs.com/">experess.js</a>. But I ran into many errors and couldn't figure a way out. So i went with the Express way 😂.</p>
<p>When you hit the payment endpoint with the data inside a POST request, it generates a checksum for the provided orderid using paytm's generate checksum logic. After successful generation it responds with the credentials for the payment page. The response from the promise by axios is used to create the HTML form by the elper function post.js and submitted immediately.</p>
<p>After Successful payment, your callback function which is src/payConf.js verifies the status of the transaction from paytm transaction status api through an unique signature. after successful verification, the callback function creates an order on your firebase database and responds with your payment succes page url.</p>
<h4>Errors</h4>
<p>I have handled most of the errors 😌. Still there is always a bug 🐛. If you ran into any issues try using console.log() to find and fix the error by using google. If you don't find any way reach me <a href="mailto:soulsam480@hotmail.com">here</a>. I'll be happy to help 👏🏼👏🏼 !!</p>
<h4>References</h4>
<p>Links to some of the resources that helped me create this project.</p>
<ul>
<li><a href="https://github.com/imlolman/Paytm-Payment-Gateway-Integration-using-Google-Cloud-Function">Satyam's Repo</a> 👏🏼</li>
<li><a href="https://medium.com/imlolman/integrate-paytm-payment-gateway-for-static-hosted-website-using-google-cloud-function-4c78385cda9f">His post on his approach</a> 👌🏼</li>
<li><a href="https://github.com/netlify/netlify-lambda">Netlify Lambda Repo</a> For improvements and bugs. 🐛</li>
<li><a href="https://github.com/dougmoscrop/serverless-http">Serverless HTTP</a> For more bugs 🐛🐛</li>
<li><a href="https://docs.netlify.com/functions/overview/">Netlify Functions</a> For reference 🎇</li>
<li><a href="https://developer.paytm.com/docs/v1/payment-gateway/">Paytm Documentation</a> For more reference 🎇🎇</li>
</ul>
<p>I'm not good at writing documentations. So if i missed something and you ran into an unknown issue please reach me on</p>
<p><a href="mailto:soulsam480@hotmail.com">mail</a> 📧 / <a href="https://twitter.com/sambitsahoojs">twitter</a> 🕊 / <a href="https://instagram.com/sambitsahoo.js">instagram</a> 🖼</p>
<p>Thank You! ✌🏼</p>
</div></div></section></main> <footer class="footer"><div class="container flex"><ul class="social-icons"><li class="icon"><a href="https://twitter.com/sambitsahoojs" target="_blank" class="nav-link"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="twitter" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="svg-inline--fa fa-twitter fa-w-16"><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg></a></li> <li class="icon"><a href="https://github.com/soulsam480" target="_blank" class="nav-link"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" class="svg-inline--fa fa-github fa-w-16"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a></li> <li class="icon"><a href="https://instagram.com/sambitsahoo.js" target="_blank" class="nav-link"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="instagram" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="svg-inline--fa fa-instagram fa-w-14"><path fill="currentColor" d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"></path></svg></a></li> <li class="icon"><a href="https://facebook.com/sahoo.sambit.7" target="_blank" class="nav-link"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="facebook" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="svg-inline--fa fa-facebook fa-w-16"><path fill="currentColor" d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"></path></svg></a></li></ul> <span style="font-size:15px">© Sambit Sahoo 2020
    </span></div></footer></div></div></div><script>window.__NUXT__={staticAssetsBase:"/_nuxt/static/1601654154",layout:"default",error:null,serverRendered:!0,routePath:"/blog/paytm-payments-for-serverless-websites",config:{}}</script><script src="/_nuxt/runtime.3eff002.js" defer></script><script src="/_nuxt/pages/blog/_slug.dd3f79c.js" defer></script><script src="/_nuxt/vendors/commons.75b201b.js" defer></script><script src="/_nuxt/app.e4de9c7.js" defer></script>
  </body>
</html>
