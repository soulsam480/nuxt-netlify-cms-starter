(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{191:function(e,t){e.exports={body:'## Paytm-Netlify-Lambda ğŸš€\r\n\r\n[Paytm](https://paytm.com) payments integration for serverless JAMstack websites using [Netlify lambda](https://www.netlify.com/products/functions/) functions. This repo will save you from the nightmare of setting up a serverless payment integration from scratch.\r\n\r\nğŸš€ It\'s live [here](https://tiaamo.com) \r\n\r\nğŸ’¥ GitHub repo is [here](https://github.com/soulsam480/paytm-netlify-lambda)\r\n\r\n### ğŸ“‘ Table of Contents\r\n\r\n* ğŸ”° [Getting Started\r\n* ğŸ“ Setup\r\n\t* ğŸŒ± Basic Setup\r\n\t* ğŸ”¥ Usage with Firebase\r\n* ğŸ—œ Integration\r\n* ğŸ““ Notes\r\n\t* ğŸ¤“ How it Works ?\r\n\t* ğŸŒ‹ Errors\r\n\t* ğŸ“” References\r\n\r\n### Getting Started\r\n\r\nTo get started clone this repo.\r\n```shell\r\ngit clone git@github.com:soulsam480/paytm-netlify-lambda.git\r\n\r\ncd paytm-netlify-lambda\r\n\r\nnpm install\r\n```\r\nTo serve the lambda functions locally we can run \r\n```shell\r\nnpm run start\r\n```\r\nBut before that we have to setup the functions otherwise there will be errors!!\r\n\r\n### Setup \r\n\r\nOpen the repo in your favorite text-editor and the file structure will be like this\r\n\r\n* config\r\n* dist\r\n* src\r\n\t* cred\r\n\t* paytm\r\n\t\t* checksum.js\r\n\t\t* crypt.js\r\n\t\t* paytm_config.js\r\n\t\t* paytmChecksum.js\r\n\t* payConf.js\r\n\t* payment.js\r\n\r\nWebpack cofig sits inside the config folder. All our functions will be build into the dist folder. So it\'s good if we don\'t touch that folder.\r\n\r\n#### Basic Setup\r\n\r\nOpen paytm_config.js inside the paytm folder.\r\n```javascript\r\nmodule.exports = {\r\n  paytm_config: {\r\n    PAYTM_ENVIRONMENT: "TEST", //possible values:  TEST | PROD\r\n    MID: " Your MID", // Get it From https://dashboard.paytm.com/next/apikeys use Test id for test purpose and Production id for Production Purpose\r\n    WEBSITE: "WEBSTAGING", // USE WEBSTAGING for testing, You Will get it for Production here https://dashboard.paytm.com/next/apikeys\r\n    CHANNEL_ID: "WEB", // Use WEB for Desktop Website and WAP for Mobile Website\r\n    INDUSTRY_TYPE_ID: "Retail", // Use Retail for Testing, For Production You Can Get it from here https://dashboard.paytm.com/next/apikeys\r\n    MERCHANT_KEY: " Your MERCHANT_KEY", // Get it From https://dashboard.paytm.com/next/apikeys use Test key for test purpose and Production key for Production Purpose\r\n    CALLBACK_URL:\r\n      "https://your_unique_site_id.netlify.app/.netlify/functions/payConf", // Modify and Use this url for verifying payment\r\n  },\r\n};\r\n```\r\nChange the MID and Merchant Key to your paytm merchant account. The callback url will be updated after you have deployed these functions to netlify. So we will leave it as it is. Again if you wish to change the parameters for production build, the respective fields will be changed with the production credentials.\r\n\r\nIf you don\'t wish to use firebase for order validation and confirmation, you can stop here and remove firebase completely from the project. If you wish to use, let\'s move in to the next step.\r\n\r\n#### Usage with Firebase\r\nWe will use [firebase-admin](npmjs.com/package/firebase-admin) sdk for nodejs to access admin privilages. With firebase admin running on server we can perform CRUD operations on realtime database easily.\r\n\r\nTo setup admin sdk you need a firebase service account. To get yourself one open you firebase admin dashboard and then project settings > service accounts. Create one for your project and download the credentials in json. Then open src/cred/authKey.js . Add the credentials in their respective places.\r\n```javascript\r\nmodule.exports = {\r\n  authKey: {\r\n    type: "service_account",\r\n    project_id: "Your Project id",\r\n    private_key_id: " Your PRIVATE_KEY_ID",\r\n    private_key: "Your PRIVATE_KEY",\r\n    client_email: "Your client email",\r\n    client_id: "Your client id",\r\n    auth_uri: "your auth uri",\r\n    token_uri: "auth token uri",\r\n    auth_provider_x509_cert_url: "cert url provider",\r\n    client_x509_cert_url: " your CERT_URL",\r\n  },\r\n};\r\n```\r\n\r\nThen open src/payConf.js and add your database URL. With this the setup is complete.\r\n\r\nAfter each successful payment firebase-admin will create an order inside \r\n```javascript\r\nOrders/dd_mm_yy(current date)/orderId\r\n```\r\nthis could be further used to verify an proceed with the payment. This is the only advantage of using firebase inside this project. If you don\'t wish to verify your orders, you can drop firebase completely and move on with the basic approach.\r\n\r\nAs the setup is complete you can deploy this project to netlify by pushing the code into an it repo. The instruction on how to deploy from a git repo is [here](https://docs.netlify.com/configure-builds/get-started/#basic-build-settings)\r\n\r\nThere are two methods to integrate these functions to your project.\r\n\r\n### Integration\r\n \r\n\r\nThis method makes a POST request to the api and creates and submits the form clent-side in browser. \r\nLet\'s move further for a good explanation.\r\n\r\nTo make API calls you have to pass these parameters inside the body of your post request. Here is an example using axios. \r\n```javascript\r\naxios({\r\n        method: "post",\r\n        url:\r\n          "https://your_unique_netliy_appname.netlify.app/.netlify/functions/payment",\r\n        data: {\r\n          amount: payment amount, //must be an integer Mandatory\r\n          name: "customer_name", // _ is allowed.no space allowed inbetween. ex. Sambit_sahoo\r\n          email: "customer_email", //valid customer email\r\n          orderid: "Order_id", //mandatory.no space allowed inbetween ex. OD123231 or OD_12324\r\n          mobile: "customer_mobileno",\r\n        },\r\n        headers: {\r\n          "Content-Type": "application/json",\r\n        },\r\n      })\r\n        .then(async (res) => {\r\n          console.log(res);\r\n          const params = res.data.params;\r\n          params["CHECKSUMHASH"] = res.data.checksum;\r\n          \r\n          //Here the helper function post.js creates the from api response and submits.\r\n          \r\n          post({\r\n            action: res.data.action,\r\n            target: "_self",\r\n            params: params,\r\n          });\r\n        })\r\n        .catch((err) => {\r\n          window.alert(err);\r\n        });\r\n\r\n```\r\nHere is the helper function which creates and submits the form client side inside browser.\r\n\r\n```javascript\r\n//This plugin is used to perform form action request from jsvascript.\r\n//This is derived from https://github.com/jisaacks/react-post/blob/master/src/post.js\r\nfunction isDate(val) {\r\n  // Cross realm comptatible\r\n  return Object.prototype.toString.call(val) === "[object Date]";\r\n}\r\n\r\nfunction isObj(val) {\r\n  return typeof val === "object";\r\n}\r\n\r\nexport function stringifyValue(val) {\r\n  if (isObj(val) && !isDate(val)) {\r\n    return JSON.stringify(val);\r\n  } else {\r\n    return val;\r\n  }\r\n}\r\n\r\nfunction buildForm({ action, target, params }) {\r\n  const form = document.createElement("form");\r\n  form.setAttribute("method", "post");\r\n  form.setAttribute("action", action);\r\n  form.setAttribute("target", target);\r\n\r\n  Object.keys(params).forEach((key) => {\r\n    const input = document.createElement("input");\r\n    input.setAttribute("type", "hidden");\r\n    input.setAttribute("name", key);\r\n    input.setAttribute("value", stringifyValue(params[key]));\r\n    form.appendChild(input);\r\n  });\r\n\r\n  return form;\r\n}\r\n\r\nexport default function post(details) {\r\n  const form = buildForm(details);\r\n  console.log(form);\r\n  document.body.appendChild(form);\r\n  form.submit();\r\n  form.remove();\r\n}\r\n```\r\nAgain after a successful payment you will be redirected to the page sent from the payment confirmation function i.e. payConf.js. \r\n\r\nTo change your response URLs \r\ngo to line 89 for payment success URL, line 93 and 96 for Failure URL.\r\n\r\n### Notes\r\nThis project is an wrapper and improvement over the project created by [Satyam](https://github.com/imlolman). You can find the github repo  [here](https://github.com/imlolman/Paytm-Payment-Gateway-Integration-using-Google-Cloud-Function). He implemented this approach using firebase cloud functions.\r\n\r\n#### How it Works\r\n[Netlify functions](https://docs.netlify.com/functions/overview/) are AWS lambda functions which return a callback for an API request. I originally intended to implement this approach without [experess.js](https://expressjs.com/). But I ran into many errors and couldn\'t figure a way out. So i went with the Express way ğŸ˜‚. \r\n\r\nWhen you hit the payment endpoint with the data inside a POST request, it generates a checksum for the provided orderid using paytm\'s generate checksum logic. After successful generation it responds with the credentials for the payment page. The response from the promise by axios is used to create the HTML form by the elper function post.js and submitted immediately.\r\n\r\nAfter Successful payment, your callback function which is src/payConf.js verifies the status of the transaction from paytm transaction status api through an unique signature. after successful verification, the callback function creates an order on your firebase database and responds with your payment succes page url.\r\n\r\n#### Errors\r\nI have handled most of the errors ğŸ˜Œ. Still there is always a bug ğŸ›. If you ran into any issues try using console.log() to find and fix the error by using google. If you don\'t find any way reach me [here](mailto:soulsam480@hotmail.com). I\'ll be happy to help ğŸ‘ğŸ¼ğŸ‘ğŸ¼ !!\r\n#### References\r\nLinks to some of the resources that helped me create this project.\r\n* [Satyam\'s Repo](https://github.com/imlolman/Paytm-Payment-Gateway-Integration-using-Google-Cloud-Function) ğŸ‘ğŸ¼\r\n* [His post on his approach](https://medium.com/imlolman/integrate-paytm-payment-gateway-for-static-hosted-website-using-google-cloud-function-4c78385cda9f) ğŸ‘ŒğŸ¼\r\n* [Netlify Lambda Repo](https://github.com/netlify/netlify-lambda) For improvements and bugs. ğŸ›\r\n* [Serverless HTTP](https://github.com/dougmoscrop/serverless-http) For more bugs ğŸ›ğŸ›\r\n* [Netlify Functions](https://docs.netlify.com/functions/overview/) For reference ğŸ‡\r\n* [Paytm Documentation](https://developer.paytm.com/docs/v1/payment-gateway/) For more reference ğŸ‡ğŸ‡\r\n\r\nI\'m not good at writing documentations. So if i missed something and you ran into an unknown issue please reach me on\r\n\r\n[mail](mailto:soulsam480@hotmail.com) ğŸ“§ / [twitter](https://twitter.com/sambitsahoojs) ğŸ•Š / [instagram](https://instagram.com/sambitsahoo.js) ğŸ–¼\r\n\r\nThank You! âœŒğŸ¼\r\n',html:'<h2>Paytm-Netlify-Lambda ğŸš€</h2>\n<p><a href="https://paytm.com">Paytm</a> payments integration for serverless JAMstack websites using <a href="https://www.netlify.com/products/functions/">Netlify lambda</a> functions. This repo will save you from the nightmare of setting up a serverless payment integration from scratch.</p>\n<p>ğŸš€ It\'s live <a href="https://tiaamo.com">here</a></p>\n<p>ğŸ’¥ GitHub repo is <a href="https://github.com/soulsam480/paytm-netlify-lambda">here</a></p>\n<h3>ğŸ“‘ Table of Contents</h3>\n<ul>\n<li>ğŸ”° [Getting Started</li>\n<li>ğŸ“ Setup\n<ul>\n<li>ğŸŒ± Basic Setup</li>\n<li>ğŸ”¥ Usage with Firebase</li>\n</ul>\n</li>\n<li>ğŸ—œ Integration</li>\n<li>ğŸ““ Notes\n<ul>\n<li>ğŸ¤“ How it Works ?</li>\n<li>ğŸŒ‹ Errors</li>\n<li>ğŸ“” References</li>\n</ul>\n</li>\n</ul>\n<h3>Getting Started</h3>\n<p>To get started clone this repo.</p>\n<pre><code class="language-shell">git clone git@github.com:soulsam480/paytm-netlify-lambda.git\n\ncd paytm-netlify-lambda\n\nnpm install\n</code></pre>\n<p>To serve the lambda functions locally we can run</p>\n<pre><code class="language-shell">npm run start\n</code></pre>\n<p>But before that we have to setup the functions otherwise there will be errors!!</p>\n<h3>Setup</h3>\n<p>Open the repo in your favorite text-editor and the file structure will be like this</p>\n<ul>\n<li>config</li>\n<li>dist</li>\n<li>src\n<ul>\n<li>cred</li>\n<li>paytm\n<ul>\n<li>checksum.js</li>\n<li>crypt.js</li>\n<li>paytm_config.js</li>\n<li>paytmChecksum.js</li>\n</ul>\n</li>\n<li>payConf.js</li>\n<li>payment.js</li>\n</ul>\n</li>\n</ul>\n<p>Webpack cofig sits inside the config folder. All our functions will be build into the dist folder. So it\'s good if we don\'t touch that folder.</p>\n<h4>Basic Setup</h4>\n<p>Open paytm_config.js inside the paytm folder.</p>\n<pre><code class="language-javascript">module.exports = {\n  paytm_config: {\n    PAYTM_ENVIRONMENT: &quot;TEST&quot;, //possible values:  TEST | PROD\n    MID: &quot; Your MID&quot;, // Get it From https://dashboard.paytm.com/next/apikeys use Test id for test purpose and Production id for Production Purpose\n    WEBSITE: &quot;WEBSTAGING&quot;, // USE WEBSTAGING for testing, You Will get it for Production here https://dashboard.paytm.com/next/apikeys\n    CHANNEL_ID: &quot;WEB&quot;, // Use WEB for Desktop Website and WAP for Mobile Website\n    INDUSTRY_TYPE_ID: &quot;Retail&quot;, // Use Retail for Testing, For Production You Can Get it from here https://dashboard.paytm.com/next/apikeys\n    MERCHANT_KEY: &quot; Your MERCHANT_KEY&quot;, // Get it From https://dashboard.paytm.com/next/apikeys use Test key for test purpose and Production key for Production Purpose\n    CALLBACK_URL:\n      &quot;https://your_unique_site_id.netlify.app/.netlify/functions/payConf&quot;, // Modify and Use this url for verifying payment\n  },\n};\n</code></pre>\n<p>Change the MID and Merchant Key to your paytm merchant account. The callback url will be updated after you have deployed these functions to netlify. So we will leave it as it is. Again if you wish to change the parameters for production build, the respective fields will be changed with the production credentials.</p>\n<p>If you don\'t wish to use firebase for order validation and confirmation, you can stop here and remove firebase completely from the project. If you wish to use, let\'s move in to the next step.</p>\n<h4>Usage with Firebase</h4>\n<p>We will use <a href="npmjs.com/package/firebase-admin">firebase-admin</a> sdk for nodejs to access admin privilages. With firebase admin running on server we can perform CRUD operations on realtime database easily.</p>\n<p>To setup admin sdk you need a firebase service account. To get yourself one open you firebase admin dashboard and then project settings &gt; service accounts. Create one for your project and download the credentials in json. Then open src/cred/authKey.js . Add the credentials in their respective places.</p>\n<pre><code class="language-javascript">module.exports = {\n  authKey: {\n    type: &quot;service_account&quot;,\n    project_id: &quot;Your Project id&quot;,\n    private_key_id: &quot; Your PRIVATE_KEY_ID&quot;,\n    private_key: &quot;Your PRIVATE_KEY&quot;,\n    client_email: &quot;Your client email&quot;,\n    client_id: &quot;Your client id&quot;,\n    auth_uri: &quot;your auth uri&quot;,\n    token_uri: &quot;auth token uri&quot;,\n    auth_provider_x509_cert_url: &quot;cert url provider&quot;,\n    client_x509_cert_url: &quot; your CERT_URL&quot;,\n  },\n};\n</code></pre>\n<p>Then open src/payConf.js and add your database URL. With this the setup is complete.</p>\n<p>After each successful payment firebase-admin will create an order inside</p>\n<pre><code class="language-javascript">Orders/dd_mm_yy(current date)/orderId\n</code></pre>\n<p>this could be further used to verify an proceed with the payment. This is the only advantage of using firebase inside this project. If you don\'t wish to verify your orders, you can drop firebase completely and move on with the basic approach.</p>\n<p>As the setup is complete you can deploy this project to netlify by pushing the code into an it repo. The instruction on how to deploy from a git repo is <a href="https://docs.netlify.com/configure-builds/get-started/#basic-build-settings">here</a></p>\n<p>There are two methods to integrate these functions to your project.</p>\n<h3>Integration</h3>\n<p>This method makes a POST request to the api and creates and submits the form clent-side in browser.\nLet\'s move further for a good explanation.</p>\n<p>To make API calls you have to pass these parameters inside the body of your post request. Here is an example using axios.</p>\n<pre><code class="language-javascript">axios({\n        method: &quot;post&quot;,\n        url:\n          &quot;https://your_unique_netliy_appname.netlify.app/.netlify/functions/payment&quot;,\n        data: {\n          amount: payment amount, //must be an integer Mandatory\n          name: &quot;customer_name&quot;, // _ is allowed.no space allowed inbetween. ex. Sambit_sahoo\n          email: &quot;customer_email&quot;, //valid customer email\n          orderid: &quot;Order_id&quot;, //mandatory.no space allowed inbetween ex. OD123231 or OD_12324\n          mobile: &quot;customer_mobileno&quot;,\n        },\n        headers: {\n          &quot;Content-Type&quot;: &quot;application/json&quot;,\n        },\n      })\n        .then(async (res) =&gt; {\n          console.log(res);\n          const params = res.data.params;\n          params[&quot;CHECKSUMHASH&quot;] = res.data.checksum;\n          \n          //Here the helper function post.js creates the from api response and submits.\n          \n          post({\n            action: res.data.action,\n            target: &quot;_self&quot;,\n            params: params,\n          });\n        })\n        .catch((err) =&gt; {\n          window.alert(err);\n        });\n\n</code></pre>\n<p>Here is the helper function which creates and submits the form client side inside browser.</p>\n<pre><code class="language-javascript">//This plugin is used to perform form action request from jsvascript.\n//This is derived from https://github.com/jisaacks/react-post/blob/master/src/post.js\nfunction isDate(val) {\n  // Cross realm comptatible\n  return Object.prototype.toString.call(val) === &quot;[object Date]&quot;;\n}\n\nfunction isObj(val) {\n  return typeof val === &quot;object&quot;;\n}\n\nexport function stringifyValue(val) {\n  if (isObj(val) &amp;&amp; !isDate(val)) {\n    return JSON.stringify(val);\n  } else {\n    return val;\n  }\n}\n\nfunction buildForm({ action, target, params }) {\n  const form = document.createElement(&quot;form&quot;);\n  form.setAttribute(&quot;method&quot;, &quot;post&quot;);\n  form.setAttribute(&quot;action&quot;, action);\n  form.setAttribute(&quot;target&quot;, target);\n\n  Object.keys(params).forEach((key) =&gt; {\n    const input = document.createElement(&quot;input&quot;);\n    input.setAttribute(&quot;type&quot;, &quot;hidden&quot;);\n    input.setAttribute(&quot;name&quot;, key);\n    input.setAttribute(&quot;value&quot;, stringifyValue(params[key]));\n    form.appendChild(input);\n  });\n\n  return form;\n}\n\nexport default function post(details) {\n  const form = buildForm(details);\n  console.log(form);\n  document.body.appendChild(form);\n  form.submit();\n  form.remove();\n}\n</code></pre>\n<p>Again after a successful payment you will be redirected to the page sent from the payment confirmation function i.e. payConf.js.</p>\n<p>To change your response URLs\ngo to line 89 for payment success URL, line 93 and 96 for Failure URL.</p>\n<h3>Notes</h3>\n<p>This project is an wrapper and improvement over the project created by <a href="https://github.com/imlolman">Satyam</a>. You can find the github repo  <a href="https://github.com/imlolman/Paytm-Payment-Gateway-Integration-using-Google-Cloud-Function">here</a>. He implemented this approach using firebase cloud functions.</p>\n<h4>How it Works</h4>\n<p><a href="https://docs.netlify.com/functions/overview/">Netlify functions</a> are AWS lambda functions which return a callback for an API request. I originally intended to implement this approach without <a href="https://expressjs.com/">experess.js</a>. But I ran into many errors and couldn\'t figure a way out. So i went with the Express way ğŸ˜‚.</p>\n<p>When you hit the payment endpoint with the data inside a POST request, it generates a checksum for the provided orderid using paytm\'s generate checksum logic. After successful generation it responds with the credentials for the payment page. The response from the promise by axios is used to create the HTML form by the elper function post.js and submitted immediately.</p>\n<p>After Successful payment, your callback function which is src/payConf.js verifies the status of the transaction from paytm transaction status api through an unique signature. after successful verification, the callback function creates an order on your firebase database and responds with your payment succes page url.</p>\n<h4>Errors</h4>\n<p>I have handled most of the errors ğŸ˜Œ. Still there is always a bug ğŸ›. If you ran into any issues try using console.log() to find and fix the error by using google. If you don\'t find any way reach me <a href="mailto:soulsam480@hotmail.com">here</a>. I\'ll be happy to help ğŸ‘ğŸ¼ğŸ‘ğŸ¼ !!</p>\n<h4>References</h4>\n<p>Links to some of the resources that helped me create this project.</p>\n<ul>\n<li><a href="https://github.com/imlolman/Paytm-Payment-Gateway-Integration-using-Google-Cloud-Function">Satyam\'s Repo</a> ğŸ‘ğŸ¼</li>\n<li><a href="https://medium.com/imlolman/integrate-paytm-payment-gateway-for-static-hosted-website-using-google-cloud-function-4c78385cda9f">His post on his approach</a> ğŸ‘ŒğŸ¼</li>\n<li><a href="https://github.com/netlify/netlify-lambda">Netlify Lambda Repo</a> For improvements and bugs. ğŸ›</li>\n<li><a href="https://github.com/dougmoscrop/serverless-http">Serverless HTTP</a> For more bugs ğŸ›ğŸ›</li>\n<li><a href="https://docs.netlify.com/functions/overview/">Netlify Functions</a> For reference ğŸ‡</li>\n<li><a href="https://developer.paytm.com/docs/v1/payment-gateway/">Paytm Documentation</a> For more reference ğŸ‡ğŸ‡</li>\n</ul>\n<p>I\'m not good at writing documentations. So if i missed something and you ran into an unknown issue please reach me on</p>\n<p><a href="mailto:soulsam480@hotmail.com">mail</a> ğŸ“§ / <a href="https://twitter.com/sambitsahoojs">twitter</a> ğŸ•Š / <a href="https://instagram.com/sambitsahoo.js">instagram</a> ğŸ–¼</p>\n<p>Thank You! âœŒğŸ¼</p>\n',attributes:{type:"js",language:"js",title:"Paytm payments for serverless websites",summary:"Paytm payments integration for serverless JAMstack websites using Netlify lambda functions. This repo will save you from the nightmare of setting up a serverless payment integration from scratch.",date:"2020-08-17T13:43:47.409Z",update:"2020-08-17T13:43:47.465Z",author:"soulsam480",authorlink:"https://github.com/soulsam480",thumbnail:"/images/uploads/group-1.png",_meta:{resourcePath:"/home/runner/work/nuxt-netlify-cms-starter/nuxt-netlify-cms-starter/content/blog/paytm-payments-for-serverless-websites.md"}},vue:{render:"return function render() { var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _vm._m(0) }",staticRenderFns:'return [function () { var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c(\'div\',{staticClass:"frontmatter-markdown"},[_c(\'h2\',[_vm._v("Paytm-Netlify-Lambda ğŸš€")]),_vm._v(" "),_c(\'p\',[_c(\'a\',{attrs:{"href":"https://paytm.com"}},[_vm._v("Paytm")]),_vm._v(" payments integration for serverless JAMstack websites using "),_c(\'a\',{attrs:{"href":"https://www.netlify.com/products/functions/"}},[_vm._v("Netlify lambda")]),_vm._v(" functions. This repo will save you from the nightmare of setting up a serverless payment integration from scratch.")]),_vm._v(" "),_c(\'p\',[_vm._v("ğŸš€ It\'s live "),_c(\'a\',{attrs:{"href":"https://tiaamo.com"}},[_vm._v("here")])]),_vm._v(" "),_c(\'p\',[_vm._v("ğŸ’¥ GitHub repo is "),_c(\'a\',{attrs:{"href":"https://github.com/soulsam480/paytm-netlify-lambda"}},[_vm._v("here")])]),_vm._v(" "),_c(\'h3\',[_vm._v("ğŸ“‘ Table of Contents")]),_vm._v(" "),_c(\'ul\',[_c(\'li\',[_vm._v("ğŸ”° [Getting Started")]),_vm._v(" "),_c(\'li\',[_vm._v("ğŸ“ Setup\\n"),_c(\'ul\',[_c(\'li\',[_vm._v("ğŸŒ± Basic Setup")]),_vm._v(" "),_c(\'li\',[_vm._v("ğŸ”¥ Usage with Firebase")])])]),_vm._v(" "),_c(\'li\',[_vm._v("ğŸ—œ Integration")]),_vm._v(" "),_c(\'li\',[_vm._v("ğŸ““ Notes\\n"),_c(\'ul\',[_c(\'li\',[_vm._v("ğŸ¤“ How it Works ?")]),_vm._v(" "),_c(\'li\',[_vm._v("ğŸŒ‹ Errors")]),_vm._v(" "),_c(\'li\',[_vm._v("ğŸ“” References")])])])]),_vm._v(" "),_c(\'h3\',[_vm._v("Getting Started")]),_vm._v(" "),_c(\'p\',[_vm._v("To get started clone this repo.")]),_vm._v(" "),_c(\'pre\',[_c(\'code\',{pre:true,attrs:{"class":"language-shell"}},[_vm._v("git clone git@github.com:soulsam480/paytm-netlify-lambda.git\\n\\ncd paytm-netlify-lambda\\n\\nnpm install\\n")])]),_vm._v(" "),_c(\'p\',[_vm._v("To serve the lambda functions locally we can run")]),_vm._v(" "),_c(\'pre\',[_c(\'code\',{pre:true,attrs:{"class":"language-shell"}},[_vm._v("npm run start\\n")])]),_vm._v(" "),_c(\'p\',[_vm._v("But before that we have to setup the functions otherwise there will be errors!!")]),_vm._v(" "),_c(\'h3\',[_vm._v("Setup")]),_vm._v(" "),_c(\'p\',[_vm._v("Open the repo in your favorite text-editor and the file structure will be like this")]),_vm._v(" "),_c(\'ul\',[_c(\'li\',[_vm._v("config")]),_vm._v(" "),_c(\'li\',[_vm._v("dist")]),_vm._v(" "),_c(\'li\',[_vm._v("src\\n"),_c(\'ul\',[_c(\'li\',[_vm._v("cred")]),_vm._v(" "),_c(\'li\',[_vm._v("paytm\\n"),_c(\'ul\',[_c(\'li\',[_vm._v("checksum.js")]),_vm._v(" "),_c(\'li\',[_vm._v("crypt.js")]),_vm._v(" "),_c(\'li\',[_vm._v("paytm_config.js")]),_vm._v(" "),_c(\'li\',[_vm._v("paytmChecksum.js")])])]),_vm._v(" "),_c(\'li\',[_vm._v("payConf.js")]),_vm._v(" "),_c(\'li\',[_vm._v("payment.js")])])])]),_vm._v(" "),_c(\'p\',[_vm._v("Webpack cofig sits inside the config folder. All our functions will be build into the dist folder. So it\'s good if we don\'t touch that folder.")]),_vm._v(" "),_c(\'h4\',[_vm._v("Basic Setup")]),_vm._v(" "),_c(\'p\',[_vm._v("Open paytm_config.js inside the paytm folder.")]),_vm._v(" "),_c(\'pre\',[_c(\'code\',{pre:true,attrs:{"class":"language-javascript"}},[_vm._v("module.exports = {\\n  paytm_config: {\\n    PAYTM_ENVIRONMENT: \\"TEST\\", //possible values:  TEST | PROD\\n    MID: \\" Your MID\\", // Get it From https://dashboard.paytm.com/next/apikeys use Test id for test purpose and Production id for Production Purpose\\n    WEBSITE: \\"WEBSTAGING\\", // USE WEBSTAGING for testing, You Will get it for Production here https://dashboard.paytm.com/next/apikeys\\n    CHANNEL_ID: \\"WEB\\", // Use WEB for Desktop Website and WAP for Mobile Website\\n    INDUSTRY_TYPE_ID: \\"Retail\\", // Use Retail for Testing, For Production You Can Get it from here https://dashboard.paytm.com/next/apikeys\\n    MERCHANT_KEY: \\" Your MERCHANT_KEY\\", // Get it From https://dashboard.paytm.com/next/apikeys use Test key for test purpose and Production key for Production Purpose\\n    CALLBACK_URL:\\n      \\"https://your_unique_site_id.netlify.app/.netlify/functions/payConf\\", // Modify and Use this url for verifying payment\\n  },\\n};\\n")])]),_vm._v(" "),_c(\'p\',[_vm._v("Change the MID and Merchant Key to your paytm merchant account. The callback url will be updated after you have deployed these functions to netlify. So we will leave it as it is. Again if you wish to change the parameters for production build, the respective fields will be changed with the production credentials.")]),_vm._v(" "),_c(\'p\',[_vm._v("If you don\'t wish to use firebase for order validation and confirmation, you can stop here and remove firebase completely from the project. If you wish to use, let\'s move in to the next step.")]),_vm._v(" "),_c(\'h4\',[_vm._v("Usage with Firebase")]),_vm._v(" "),_c(\'p\',[_vm._v("We will use "),_c(\'a\',{attrs:{"href":"npmjs.com/package/firebase-admin"}},[_vm._v("firebase-admin")]),_vm._v(" sdk for nodejs to access admin privilages. With firebase admin running on server we can perform CRUD operations on realtime database easily.")]),_vm._v(" "),_c(\'p\',[_vm._v("To setup admin sdk you need a firebase service account. To get yourself one open you firebase admin dashboard and then project settings > service accounts. Create one for your project and download the credentials in json. Then open src/cred/authKey.js . Add the credentials in their respective places.")]),_vm._v(" "),_c(\'pre\',[_c(\'code\',{pre:true,attrs:{"class":"language-javascript"}},[_vm._v("module.exports = {\\n  authKey: {\\n    type: \\"service_account\\",\\n    project_id: \\"Your Project id\\",\\n    private_key_id: \\" Your PRIVATE_KEY_ID\\",\\n    private_key: \\"Your PRIVATE_KEY\\",\\n    client_email: \\"Your client email\\",\\n    client_id: \\"Your client id\\",\\n    auth_uri: \\"your auth uri\\",\\n    token_uri: \\"auth token uri\\",\\n    auth_provider_x509_cert_url: \\"cert url provider\\",\\n    client_x509_cert_url: \\" your CERT_URL\\",\\n  },\\n};\\n")])]),_vm._v(" "),_c(\'p\',[_vm._v("Then open src/payConf.js and add your database URL. With this the setup is complete.")]),_vm._v(" "),_c(\'p\',[_vm._v("After each successful payment firebase-admin will create an order inside")]),_vm._v(" "),_c(\'pre\',[_c(\'code\',{pre:true,attrs:{"class":"language-javascript"}},[_vm._v("Orders/dd_mm_yy(current date)/orderId\\n")])]),_vm._v(" "),_c(\'p\',[_vm._v("this could be further used to verify an proceed with the payment. This is the only advantage of using firebase inside this project. If you don\'t wish to verify your orders, you can drop firebase completely and move on with the basic approach.")]),_vm._v(" "),_c(\'p\',[_vm._v("As the setup is complete you can deploy this project to netlify by pushing the code into an it repo. The instruction on how to deploy from a git repo is "),_c(\'a\',{attrs:{"href":"https://docs.netlify.com/configure-builds/get-started/#basic-build-settings"}},[_vm._v("here")])]),_vm._v(" "),_c(\'p\',[_vm._v("There are two methods to integrate these functions to your project.")]),_vm._v(" "),_c(\'h3\',[_vm._v("Integration")]),_vm._v(" "),_c(\'p\',[_vm._v("This method makes a POST request to the api and creates and submits the form clent-side in browser.\\nLet\'s move further for a good explanation.")]),_vm._v(" "),_c(\'p\',[_vm._v("To make API calls you have to pass these parameters inside the body of your post request. Here is an example using axios.")]),_vm._v(" "),_c(\'pre\',[_c(\'code\',{pre:true,attrs:{"class":"language-javascript"}},[_vm._v("axios({\\n        method: \\"post\\",\\n        url:\\n          \\"https://your_unique_netliy_appname.netlify.app/.netlify/functions/payment\\",\\n        data: {\\n          amount: payment amount, //must be an integer Mandatory\\n          name: \\"customer_name\\", // _ is allowed.no space allowed inbetween. ex. Sambit_sahoo\\n          email: \\"customer_email\\", //valid customer email\\n          orderid: \\"Order_id\\", //mandatory.no space allowed inbetween ex. OD123231 or OD_12324\\n          mobile: \\"customer_mobileno\\",\\n        },\\n        headers: {\\n          \\"Content-Type\\": \\"application/json\\",\\n        },\\n      })\\n        .then(async (res) => {\\n          console.log(res);\\n          const params = res.data.params;\\n          params[\\"CHECKSUMHASH\\"] = res.data.checksum;\\n          \\n          //Here the helper function post.js creates the from api response and submits.\\n          \\n          post({\\n            action: res.data.action,\\n            target: \\"_self\\",\\n            params: params,\\n          });\\n        })\\n        .catch((err) => {\\n          window.alert(err);\\n        });\\n\\n")])]),_vm._v(" "),_c(\'p\',[_vm._v("Here is the helper function which creates and submits the form client side inside browser.")]),_vm._v(" "),_c(\'pre\',[_c(\'code\',{pre:true,attrs:{"class":"language-javascript"}},[_vm._v("//This plugin is used to perform form action request from jsvascript.\\n//This is derived from https://github.com/jisaacks/react-post/blob/master/src/post.js\\nfunction isDate(val) {\\n  // Cross realm comptatible\\n  return Object.prototype.toString.call(val) === \\"[object Date]\\";\\n}\\n\\nfunction isObj(val) {\\n  return typeof val === \\"object\\";\\n}\\n\\nexport function stringifyValue(val) {\\n  if (isObj(val) && !isDate(val)) {\\n    return JSON.stringify(val);\\n  } else {\\n    return val;\\n  }\\n}\\n\\nfunction buildForm({ action, target, params }) {\\n  const form = document.createElement(\\"form\\");\\n  form.setAttribute(\\"method\\", \\"post\\");\\n  form.setAttribute(\\"action\\", action);\\n  form.setAttribute(\\"target\\", target);\\n\\n  Object.keys(params).forEach((key) => {\\n    const input = document.createElement(\\"input\\");\\n    input.setAttribute(\\"type\\", \\"hidden\\");\\n    input.setAttribute(\\"name\\", key);\\n    input.setAttribute(\\"value\\", stringifyValue(params[key]));\\n    form.appendChild(input);\\n  });\\n\\n  return form;\\n}\\n\\nexport default function post(details) {\\n  const form = buildForm(details);\\n  console.log(form);\\n  document.body.appendChild(form);\\n  form.submit();\\n  form.remove();\\n}\\n")])]),_vm._v(" "),_c(\'p\',[_vm._v("Again after a successful payment you will be redirected to the page sent from the payment confirmation function i.e. payConf.js.")]),_vm._v(" "),_c(\'p\',[_vm._v("To change your response URLs\\ngo to line 89 for payment success URL, line 93 and 96 for Failure URL.")]),_vm._v(" "),_c(\'h3\',[_vm._v("Notes")]),_vm._v(" "),_c(\'p\',[_vm._v("This project is an wrapper and improvement over the project created by "),_c(\'a\',{attrs:{"href":"https://github.com/imlolman"}},[_vm._v("Satyam")]),_vm._v(". You can find the github repo  "),_c(\'a\',{attrs:{"href":"https://github.com/imlolman/Paytm-Payment-Gateway-Integration-using-Google-Cloud-Function"}},[_vm._v("here")]),_vm._v(". He implemented this approach using firebase cloud functions.")]),_vm._v(" "),_c(\'h4\',[_vm._v("How it Works")]),_vm._v(" "),_c(\'p\',[_c(\'a\',{attrs:{"href":"https://docs.netlify.com/functions/overview/"}},[_vm._v("Netlify functions")]),_vm._v(" are AWS lambda functions which return a callback for an API request. I originally intended to implement this approach without "),_c(\'a\',{attrs:{"href":"https://expressjs.com/"}},[_vm._v("experess.js")]),_vm._v(". But I ran into many errors and couldn\'t figure a way out. So i went with the Express way ğŸ˜‚.")]),_vm._v(" "),_c(\'p\',[_vm._v("When you hit the payment endpoint with the data inside a POST request, it generates a checksum for the provided orderid using paytm\'s generate checksum logic. After successful generation it responds with the credentials for the payment page. The response from the promise by axios is used to create the HTML form by the elper function post.js and submitted immediately.")]),_vm._v(" "),_c(\'p\',[_vm._v("After Successful payment, your callback function which is src/payConf.js verifies the status of the transaction from paytm transaction status api through an unique signature. after successful verification, the callback function creates an order on your firebase database and responds with your payment succes page url.")]),_vm._v(" "),_c(\'h4\',[_vm._v("Errors")]),_vm._v(" "),_c(\'p\',[_vm._v("I have handled most of the errors ğŸ˜Œ. Still there is always a bug ğŸ›. If you ran into any issues try using console.log() to find and fix the error by using google. If you don\'t find any way reach me "),_c(\'a\',{attrs:{"href":"mailto:soulsam480@hotmail.com"}},[_vm._v("here")]),_vm._v(". I\'ll be happy to help ğŸ‘ğŸ¼ğŸ‘ğŸ¼ !!")]),_vm._v(" "),_c(\'h4\',[_vm._v("References")]),_vm._v(" "),_c(\'p\',[_vm._v("Links to some of the resources that helped me create this project.")]),_vm._v(" "),_c(\'ul\',[_c(\'li\',[_c(\'a\',{attrs:{"href":"https://github.com/imlolman/Paytm-Payment-Gateway-Integration-using-Google-Cloud-Function"}},[_vm._v("Satyam\'s Repo")]),_vm._v(" ğŸ‘ğŸ¼")]),_vm._v(" "),_c(\'li\',[_c(\'a\',{attrs:{"href":"https://medium.com/imlolman/integrate-paytm-payment-gateway-for-static-hosted-website-using-google-cloud-function-4c78385cda9f"}},[_vm._v("His post on his approach")]),_vm._v(" ğŸ‘ŒğŸ¼")]),_vm._v(" "),_c(\'li\',[_c(\'a\',{attrs:{"href":"https://github.com/netlify/netlify-lambda"}},[_vm._v("Netlify Lambda Repo")]),_vm._v(" For improvements and bugs. ğŸ›")]),_vm._v(" "),_c(\'li\',[_c(\'a\',{attrs:{"href":"https://github.com/dougmoscrop/serverless-http"}},[_vm._v("Serverless HTTP")]),_vm._v(" For more bugs ğŸ›ğŸ›")]),_vm._v(" "),_c(\'li\',[_c(\'a\',{attrs:{"href":"https://docs.netlify.com/functions/overview/"}},[_vm._v("Netlify Functions")]),_vm._v(" For reference ğŸ‡")]),_vm._v(" "),_c(\'li\',[_c(\'a\',{attrs:{"href":"https://developer.paytm.com/docs/v1/payment-gateway/"}},[_vm._v("Paytm Documentation")]),_vm._v(" For more reference ğŸ‡ğŸ‡")])]),_vm._v(" "),_c(\'p\',[_vm._v("I\'m not good at writing documentations. So if i missed something and you ran into an unknown issue please reach me on")]),_vm._v(" "),_c(\'p\',[_c(\'a\',{attrs:{"href":"mailto:soulsam480@hotmail.com"}},[_vm._v("mail")]),_vm._v(" ğŸ“§ / "),_c(\'a\',{attrs:{"href":"https://twitter.com/sambitsahoojs"}},[_vm._v("twitter")]),_vm._v(" ğŸ•Š / "),_c(\'a\',{attrs:{"href":"https://instagram.com/sambitsahoo.js"}},[_vm._v("instagram")]),_vm._v(" ğŸ–¼")]),_vm._v(" "),_c(\'p\',[_vm._v("Thank You! âœŒğŸ¼")])]) }]',component:{data:function(){return{templateRender:null}},render:function(e){return this.templateRender?this.templateRender():e("div","Rendering")},created:function(){this.templateRender=function(){var e=this.$createElement;this._self._c;return this._m(0)},this.$options.staticRenderFns=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"frontmatter-markdown"},[n("h2",[e._v("Paytm-Netlify-Lambda ğŸš€")]),e._v(" "),n("p",[n("a",{attrs:{href:"https://paytm.com"}},[e._v("Paytm")]),e._v(" payments integration for serverless JAMstack websites using "),n("a",{attrs:{href:"https://www.netlify.com/products/functions/"}},[e._v("Netlify lambda")]),e._v(" functions. This repo will save you from the nightmare of setting up a serverless payment integration from scratch.")]),e._v(" "),n("p",[e._v("ğŸš€ It's live "),n("a",{attrs:{href:"https://tiaamo.com"}},[e._v("here")])]),e._v(" "),n("p",[e._v("ğŸ’¥ GitHub repo is "),n("a",{attrs:{href:"https://github.com/soulsam480/paytm-netlify-lambda"}},[e._v("here")])]),e._v(" "),n("h3",[e._v("ğŸ“‘ Table of Contents")]),e._v(" "),n("ul",[n("li",[e._v("ğŸ”° [Getting Started")]),e._v(" "),n("li",[e._v("ğŸ“ Setup\n"),n("ul",[n("li",[e._v("ğŸŒ± Basic Setup")]),e._v(" "),n("li",[e._v("ğŸ”¥ Usage with Firebase")])])]),e._v(" "),n("li",[e._v("ğŸ—œ Integration")]),e._v(" "),n("li",[e._v("ğŸ““ Notes\n"),n("ul",[n("li",[e._v("ğŸ¤“ How it Works ?")]),e._v(" "),n("li",[e._v("ğŸŒ‹ Errors")]),e._v(" "),n("li",[e._v("ğŸ“” References")])])])]),e._v(" "),n("h3",[e._v("Getting Started")]),e._v(" "),n("p",[e._v("To get started clone this repo.")]),e._v(" "),n("pre",[n("code",{pre:!0,attrs:{class:"language-shell"}},[e._v("git clone git@github.com:soulsam480/paytm-netlify-lambda.git\n\ncd paytm-netlify-lambda\n\nnpm install\n")])]),e._v(" "),n("p",[e._v("To serve the lambda functions locally we can run")]),e._v(" "),n("pre",[n("code",{pre:!0,attrs:{class:"language-shell"}},[e._v("npm run start\n")])]),e._v(" "),n("p",[e._v("But before that we have to setup the functions otherwise there will be errors!!")]),e._v(" "),n("h3",[e._v("Setup")]),e._v(" "),n("p",[e._v("Open the repo in your favorite text-editor and the file structure will be like this")]),e._v(" "),n("ul",[n("li",[e._v("config")]),e._v(" "),n("li",[e._v("dist")]),e._v(" "),n("li",[e._v("src\n"),n("ul",[n("li",[e._v("cred")]),e._v(" "),n("li",[e._v("paytm\n"),n("ul",[n("li",[e._v("checksum.js")]),e._v(" "),n("li",[e._v("crypt.js")]),e._v(" "),n("li",[e._v("paytm_config.js")]),e._v(" "),n("li",[e._v("paytmChecksum.js")])])]),e._v(" "),n("li",[e._v("payConf.js")]),e._v(" "),n("li",[e._v("payment.js")])])])]),e._v(" "),n("p",[e._v("Webpack cofig sits inside the config folder. All our functions will be build into the dist folder. So it's good if we don't touch that folder.")]),e._v(" "),n("h4",[e._v("Basic Setup")]),e._v(" "),n("p",[e._v("Open paytm_config.js inside the paytm folder.")]),e._v(" "),n("pre",[n("code",{pre:!0,attrs:{class:"language-javascript"}},[e._v('module.exports = {\n  paytm_config: {\n    PAYTM_ENVIRONMENT: "TEST", //possible values:  TEST | PROD\n    MID: " Your MID", // Get it From https://dashboard.paytm.com/next/apikeys use Test id for test purpose and Production id for Production Purpose\n    WEBSITE: "WEBSTAGING", // USE WEBSTAGING for testing, You Will get it for Production here https://dashboard.paytm.com/next/apikeys\n    CHANNEL_ID: "WEB", // Use WEB for Desktop Website and WAP for Mobile Website\n    INDUSTRY_TYPE_ID: "Retail", // Use Retail for Testing, For Production You Can Get it from here https://dashboard.paytm.com/next/apikeys\n    MERCHANT_KEY: " Your MERCHANT_KEY", // Get it From https://dashboard.paytm.com/next/apikeys use Test key for test purpose and Production key for Production Purpose\n    CALLBACK_URL:\n      "https://your_unique_site_id.netlify.app/.netlify/functions/payConf", // Modify and Use this url for verifying payment\n  },\n};\n')])]),e._v(" "),n("p",[e._v("Change the MID and Merchant Key to your paytm merchant account. The callback url will be updated after you have deployed these functions to netlify. So we will leave it as it is. Again if you wish to change the parameters for production build, the respective fields will be changed with the production credentials.")]),e._v(" "),n("p",[e._v("If you don't wish to use firebase for order validation and confirmation, you can stop here and remove firebase completely from the project. If you wish to use, let's move in to the next step.")]),e._v(" "),n("h4",[e._v("Usage with Firebase")]),e._v(" "),n("p",[e._v("We will use "),n("a",{attrs:{href:"npmjs.com/package/firebase-admin"}},[e._v("firebase-admin")]),e._v(" sdk for nodejs to access admin privilages. With firebase admin running on server we can perform CRUD operations on realtime database easily.")]),e._v(" "),n("p",[e._v("To setup admin sdk you need a firebase service account. To get yourself one open you firebase admin dashboard and then project settings > service accounts. Create one for your project and download the credentials in json. Then open src/cred/authKey.js . Add the credentials in their respective places.")]),e._v(" "),n("pre",[n("code",{pre:!0,attrs:{class:"language-javascript"}},[e._v('module.exports = {\n  authKey: {\n    type: "service_account",\n    project_id: "Your Project id",\n    private_key_id: " Your PRIVATE_KEY_ID",\n    private_key: "Your PRIVATE_KEY",\n    client_email: "Your client email",\n    client_id: "Your client id",\n    auth_uri: "your auth uri",\n    token_uri: "auth token uri",\n    auth_provider_x509_cert_url: "cert url provider",\n    client_x509_cert_url: " your CERT_URL",\n  },\n};\n')])]),e._v(" "),n("p",[e._v("Then open src/payConf.js and add your database URL. With this the setup is complete.")]),e._v(" "),n("p",[e._v("After each successful payment firebase-admin will create an order inside")]),e._v(" "),n("pre",[n("code",{pre:!0,attrs:{class:"language-javascript"}},[e._v("Orders/dd_mm_yy(current date)/orderId\n")])]),e._v(" "),n("p",[e._v("this could be further used to verify an proceed with the payment. This is the only advantage of using firebase inside this project. If you don't wish to verify your orders, you can drop firebase completely and move on with the basic approach.")]),e._v(" "),n("p",[e._v("As the setup is complete you can deploy this project to netlify by pushing the code into an it repo. The instruction on how to deploy from a git repo is "),n("a",{attrs:{href:"https://docs.netlify.com/configure-builds/get-started/#basic-build-settings"}},[e._v("here")])]),e._v(" "),n("p",[e._v("There are two methods to integrate these functions to your project.")]),e._v(" "),n("h3",[e._v("Integration")]),e._v(" "),n("p",[e._v("This method makes a POST request to the api and creates and submits the form clent-side in browser.\nLet's move further for a good explanation.")]),e._v(" "),n("p",[e._v("To make API calls you have to pass these parameters inside the body of your post request. Here is an example using axios.")]),e._v(" "),n("pre",[n("code",{pre:!0,attrs:{class:"language-javascript"}},[e._v('axios({\n        method: "post",\n        url:\n          "https://your_unique_netliy_appname.netlify.app/.netlify/functions/payment",\n        data: {\n          amount: payment amount, //must be an integer Mandatory\n          name: "customer_name", // _ is allowed.no space allowed inbetween. ex. Sambit_sahoo\n          email: "customer_email", //valid customer email\n          orderid: "Order_id", //mandatory.no space allowed inbetween ex. OD123231 or OD_12324\n          mobile: "customer_mobileno",\n        },\n        headers: {\n          "Content-Type": "application/json",\n        },\n      })\n        .then(async (res) => {\n          console.log(res);\n          const params = res.data.params;\n          params["CHECKSUMHASH"] = res.data.checksum;\n          \n          //Here the helper function post.js creates the from api response and submits.\n          \n          post({\n            action: res.data.action,\n            target: "_self",\n            params: params,\n          });\n        })\n        .catch((err) => {\n          window.alert(err);\n        });\n\n')])]),e._v(" "),n("p",[e._v("Here is the helper function which creates and submits the form client side inside browser.")]),e._v(" "),n("pre",[n("code",{pre:!0,attrs:{class:"language-javascript"}},[e._v('//This plugin is used to perform form action request from jsvascript.\n//This is derived from https://github.com/jisaacks/react-post/blob/master/src/post.js\nfunction isDate(val) {\n  // Cross realm comptatible\n  return Object.prototype.toString.call(val) === "[object Date]";\n}\n\nfunction isObj(val) {\n  return typeof val === "object";\n}\n\nexport function stringifyValue(val) {\n  if (isObj(val) && !isDate(val)) {\n    return JSON.stringify(val);\n  } else {\n    return val;\n  }\n}\n\nfunction buildForm({ action, target, params }) {\n  const form = document.createElement("form");\n  form.setAttribute("method", "post");\n  form.setAttribute("action", action);\n  form.setAttribute("target", target);\n\n  Object.keys(params).forEach((key) => {\n    const input = document.createElement("input");\n    input.setAttribute("type", "hidden");\n    input.setAttribute("name", key);\n    input.setAttribute("value", stringifyValue(params[key]));\n    form.appendChild(input);\n  });\n\n  return form;\n}\n\nexport default function post(details) {\n  const form = buildForm(details);\n  console.log(form);\n  document.body.appendChild(form);\n  form.submit();\n  form.remove();\n}\n')])]),e._v(" "),n("p",[e._v("Again after a successful payment you will be redirected to the page sent from the payment confirmation function i.e. payConf.js.")]),e._v(" "),n("p",[e._v("To change your response URLs\ngo to line 89 for payment success URL, line 93 and 96 for Failure URL.")]),e._v(" "),n("h3",[e._v("Notes")]),e._v(" "),n("p",[e._v("This project is an wrapper and improvement over the project created by "),n("a",{attrs:{href:"https://github.com/imlolman"}},[e._v("Satyam")]),e._v(". You can find the github repo  "),n("a",{attrs:{href:"https://github.com/imlolman/Paytm-Payment-Gateway-Integration-using-Google-Cloud-Function"}},[e._v("here")]),e._v(". He implemented this approach using firebase cloud functions.")]),e._v(" "),n("h4",[e._v("How it Works")]),e._v(" "),n("p",[n("a",{attrs:{href:"https://docs.netlify.com/functions/overview/"}},[e._v("Netlify functions")]),e._v(" are AWS lambda functions which return a callback for an API request. I originally intended to implement this approach without "),n("a",{attrs:{href:"https://expressjs.com/"}},[e._v("experess.js")]),e._v(". But I ran into many errors and couldn't figure a way out. So i went with the Express way ğŸ˜‚.")]),e._v(" "),n("p",[e._v("When you hit the payment endpoint with the data inside a POST request, it generates a checksum for the provided orderid using paytm's generate checksum logic. After successful generation it responds with the credentials for the payment page. The response from the promise by axios is used to create the HTML form by the elper function post.js and submitted immediately.")]),e._v(" "),n("p",[e._v("After Successful payment, your callback function which is src/payConf.js verifies the status of the transaction from paytm transaction status api through an unique signature. after successful verification, the callback function creates an order on your firebase database and responds with your payment succes page url.")]),e._v(" "),n("h4",[e._v("Errors")]),e._v(" "),n("p",[e._v("I have handled most of the errors ğŸ˜Œ. Still there is always a bug ğŸ›. If you ran into any issues try using console.log() to find and fix the error by using google. If you don't find any way reach me "),n("a",{attrs:{href:"mailto:soulsam480@hotmail.com"}},[e._v("here")]),e._v(". I'll be happy to help ğŸ‘ğŸ¼ğŸ‘ğŸ¼ !!")]),e._v(" "),n("h4",[e._v("References")]),e._v(" "),n("p",[e._v("Links to some of the resources that helped me create this project.")]),e._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://github.com/imlolman/Paytm-Payment-Gateway-Integration-using-Google-Cloud-Function"}},[e._v("Satyam's Repo")]),e._v(" ğŸ‘ğŸ¼")]),e._v(" "),n("li",[n("a",{attrs:{href:"https://medium.com/imlolman/integrate-paytm-payment-gateway-for-static-hosted-website-using-google-cloud-function-4c78385cda9f"}},[e._v("His post on his approach")]),e._v(" ğŸ‘ŒğŸ¼")]),e._v(" "),n("li",[n("a",{attrs:{href:"https://github.com/netlify/netlify-lambda"}},[e._v("Netlify Lambda Repo")]),e._v(" For improvements and bugs. ğŸ›")]),e._v(" "),n("li",[n("a",{attrs:{href:"https://github.com/dougmoscrop/serverless-http"}},[e._v("Serverless HTTP")]),e._v(" For more bugs ğŸ›ğŸ›")]),e._v(" "),n("li",[n("a",{attrs:{href:"https://docs.netlify.com/functions/overview/"}},[e._v("Netlify Functions")]),e._v(" For reference ğŸ‡")]),e._v(" "),n("li",[n("a",{attrs:{href:"https://developer.paytm.com/docs/v1/payment-gateway/"}},[e._v("Paytm Documentation")]),e._v(" For more reference ğŸ‡ğŸ‡")])]),e._v(" "),n("p",[e._v("I'm not good at writing documentations. So if i missed something and you ran into an unknown issue please reach me on")]),e._v(" "),n("p",[n("a",{attrs:{href:"mailto:soulsam480@hotmail.com"}},[e._v("mail")]),e._v(" ğŸ“§ / "),n("a",{attrs:{href:"https://twitter.com/sambitsahoojs"}},[e._v("twitter")]),e._v(" ğŸ•Š / "),n("a",{attrs:{href:"https://instagram.com/sambitsahoo.js"}},[e._v("instagram")]),e._v(" ğŸ–¼")]),e._v(" "),n("p",[e._v("Thank You! âœŒğŸ¼")])])}]}}}}}}]);